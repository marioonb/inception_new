# Default server configuration
#
server {

        listen 443 ssl;
        listen [::]:443 ssl;

       # sinon me fait une erreur : The plain HTTP request was sent to HTTPS port, il ne fait pas le lien seul entre http et https
        error_page	497	https://$server_name:$server_port$request_uri;

        server_name mbelorge.42.fr;
        #ssl on;
        # SSL configuration
        #
        #listen 443 ssl default_server;
    	#listen [::]:443 ssl default_server;
        #
        # Note: You should disable gzip for SSL traffic.
        # See: https://bugs.debian.org/773332
        #
        # Read up on ssl_ciphers to ensure a secure configuration.
        # See: https://bugs.debian.org/765782
        #
        # Self signed certs generated by the ssl-cert package
        # Don't use them in a production server!
        #
        # include snippets/snakeoil.conf;
        ssl_certificate		/etc/nginx/ssl/mbelorge.42.fr.crt;
	ssl_certificate_key	/etc/nginx/ssl/mbelorge.42.fr.key;
	ssl_protocols		TLSv1.2 TLSv1.3;

        #root /var/www/html;
        root /var/www/wordpress;
        # Add index.php to the list if you are using PHP
        index index.php index.html index.html index.nginx-debian.html;

        

        location / {
                # First attempt to serve request as file, then
                # as directory, then fall back to displaying a 404.
                try_files $uri $uri/ =404;

                
        }

		# Pour gérer php -> vidéo à 18'57 --> https://www.youtube.com/watch?v=gZ6uwd2ki4s

        # pass PHP scripts to FastCGI server
        location ~ \.php$ {
               	#include snippets/fastcgi-php.conf;
                # With php-fpm (or other unix sockets):  // Si meme conteneur 
                        #fastcgi_pass unix:/run/php/php7.3-fpm.sock;
                # With php-cgi (or other tcp sockets):
                        #fastcgi_pass 127.0.0.1:9000;
			#try_files $uri =404;
			fastcgi_pass wordpress:9000;
                        fastcgi_index index.php;
                        #root /var/www/wordpress;
    			fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
    			include fastcgi_params;  
                }

}




